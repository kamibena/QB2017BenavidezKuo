---
title: "QB2017_BK_Ranalyses"
author: "Venus Kuo and Michelle B."
date: "February 11, 2017"
output: html_document
---

```{r setup}
## Setup work enviroment ##
rm(list = ls())
setwd("C:/Users/Venus/Github/QB2017BenavidezKuo/data")

## Load packages ##
require("vegan")  
require("tidyr")
require(dplyr)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
## Load dataset ##
# From BCI, Panama from year 2000 #
BCI <- read.delim("BCI2010.txt", header=T)

## Transform census data into site by species matrix ##
BCI.SbyS <- group_by(BCI, Quadrat) %>% count(Latin) %>% spread(key=Latin, value=n , fill=0)

BCI.SBS <- BCI.SbyS[ ,-1]

# Slim down BCI data frame #
BCI.dat <- subset(BCI, select = c(Latin, Quadrat, PX, PY))


```  



```{r}
# Manually subsetting # 
#dat <- subset(BCI, Quadrat ==0 , select = c(Latin, Quadrat, PX, PY))

# Randomly sampling one individual or row #
# In <- dat[sample(nrow(dat), 1), ]

# Sample indivudals from BCI #
ilist <- dat[sample(nrow(dat), size = 100, replace = FALSE), ]
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}

# For loop to sample 1 individual and nearest neighbors # 
main.dat <- NA
nrows.1 <- nrow(ilist)
for(i in 1:nrows.1) {
  x1 <- as.numeric(ilist[i,]["PX"])
  y1 <- as.numeric(ilist[i,]["PY"])
  spID <- ilist[i,]["Latin"]
  z <- cbind(spID, x1, y1)
  
  zz.dat <- NA
  
  nrows <- nrow(dat)
  for(j in 1:nrows) {
    
      x2 <- as.numeric(dat[j,]["PX"])
      y2 <- as.numeric(dat[j,]["PY"])
      spID2 <- dat[j,]["Latin"]
      
      #print(x2)
      #print(y2)
      #print(spID2)
      #break
      
      dist <- sqrt(((x1-x2)^2)+((y1-y2)^2))
      zz <- paste(spID2, x2, y2, dist)
      zz.dat <- rbind(zz)
    }
  
  print(zz.dat)
  break()
  
}



```

Alpha Diversity business below

```{r}
#Good's coverage
C <- function(x = ""){
  1 - (sum(x == 1) / rowSums(x))
}

#Coverage ranges from 0.75 - 0.99

#Rank Abundance

####for one site
BCI2=as.data.frame(BCI.SBS)
Racresults=radfit(BCI2[100,])
plot(Racresults,las=1,cex.lab=1.4,cex.axis=1.25)

####for sites combined
BCI.sum=rowSums(BCI2)
BCI.sum=as.data.frame(BCI.sum)
BCI.sum=t(BCI.sum)
BCI.sum=as.data.frame(BCI.sum)

Racresults=radfit(BCI.sum)
plot(Racresults,las=1,cex.lab=1.4,cex.axis=1.25)


BCIcooc <- cooccur::cooccur(mat = BCI2, type = "spp_site",
                   thresh = T, spp_names = T)

summary(BCIcooc)

table=prop.table(BCIcooc)







